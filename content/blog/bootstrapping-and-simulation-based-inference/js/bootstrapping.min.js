barsContainer=document.getElementById("bars-container"),ciLowerElements=document.querySelectorAll(".ci-lower"),ciUpperElements=document.querySelectorAll(".ci-upper"),largestMeanElement=document.getElementById("largest-mean"),lastBootstrappedSampleMean=document.getElementById("last-bootstrapped-sample-mean"),lastSampleElement=document.getElementById("last-bootstrapped-sample"),modeMeanElement=document.getElementById("mode-mean"),originalSampleElement=document.getElementById("original-sample"),smallestMeanElement=document.getElementById("smallest-mean"),totalBootstrappedSamplesElement=document.getElementById("total-bootstrapped-samples"),ciText=document.getElementById("ci-text");function getColor(){const e=360*Math.random(),t=65+80*Math.random(),a=85+5*Math.random();return{background:`hsla(${e}, ${t}%, ${a}%, 0.5)`,border:`hsl(${e}, ${t}%, ${a-20}%)`}}const clearElementChildren=e=>{e.innerHTML=""},calculateMean=e=>{let t=0;for(let a=0;a<e.children.length;a++)t+=parseInt(e.children[a].textContent);return(t/e.children.length).toFixed(1)},createBall=e=>{const t=document.createElement("div");if(t.className="number-circle",t.textContent=e,"?"!==e){const e=getColor();t.style.backgroundColor=e.background,t.style.border=`2px solid ${e.border}`}else t.style.backgroundColor="#FFFFFF",t.style.border="2px solid #D4D4D4";return t},initializeSample=(e,t,a)=>{clearElementChildren(e);for(let t=0;t<10;t++){const t=a||Math.floor(16*Math.random());e.appendChild(createBall(t))}const n=calculateMean(e);document.getElementById(t).textContent=n};let originalSampleMean;const initializeOriginalSample=()=>{initializeSample(originalSampleElement,"original-sample-mean"),originalSampleMean=calculateMean(originalSampleElement)},initializeBootstrapSample=()=>{initializeSample(lastSampleElement,"last-bootstrapped-sample-mean","?"),lastBootstrappedSampleMean.textContent="?"},createBootstrapSample=()=>{clearElementChildren(lastSampleElement);for(let e=0;e<10;e++){const e=Math.floor(10*Math.random()),t=originalSampleElement.children[e].cloneNode(!0);lastSampleElement.appendChild(t)}lastBootstrappedSampleMean.textContent=calculateMean(lastSampleElement)};function createSamplesAndUpdateHistogram(e){for(let t=0;t<e;t++){createBootstrapSample();const e=calculateMean(lastSampleElement);updateHistogramData(e),updateTotalBootstrappedSamples()}}const updateTotalBootstrappedSamples=()=>{const e=[...histogramData.values()].reduce(((e,t)=>e+t),0);totalBootstrappedSamplesElement.textContent=e},histogramData=new Map,updateHistogramData=e=>{const t=e,a=histogramData.get(t)||0;histogramData.set(t,a+1)};barsContainer.addEventListener("touchend",(e=>{e.target.classList.contains("histogram-bar")&&(e.preventDefault(),toggleTooltip(e.target))}));const renderHistogram=()=>{clearElementChildren(barsContainer);const e=[...histogramData.entries()].sort(((e,t)=>e[0]-t[0])),t=Math.max(...histogramData.values());e.forEach((([e,a])=>{const n=Math.round(100*e)/100,l=a/t*100,o=document.createElement("div");o.className="histogram-bar",o.style.height=`${l}%`,o.style.backgroundColor=n==originalSampleMean?"var(--complementary-color)":void 0,o.dataset.mean=n,o.dataset.count=a,barsContainer.appendChild(o)})),updateHistogramStats(),updateConfidenceInterval()},updateHistogramStats=()=>{const e=[...histogramData.entries()].sort(((e,t)=>parseFloat(e[0])-parseFloat(t[0]))),t=e[0][0],a=e[e.length-1][0],n=[...histogramData.entries()].reduce(((e,t)=>t[1]>e[1]?t:e))[0];smallestMeanElement.textContent=t,largestMeanElement.textContent=a,modeMeanElement.textContent=n},toggleTooltip=e=>{if(e.classList.contains("active-tooltip"))e.classList.remove("active-tooltip");else{document.querySelectorAll(".histogram-bar").forEach((e=>e.classList.remove("active-tooltip"))),e.classList.add("active-tooltip")}},calculateConfidenceInterval=()=>{const e=[...histogramData.keys()].map(parseFloat).sort(((e,t)=>e-t)),t=Math.floor(.025*e.length),a=Math.ceil(.975*e.length)-1;return{lower:e[t],upper:e[a]}},updateConfidenceInterval=()=>{const e=calculateConfidenceInterval();ciLowerElements.forEach((t=>{t.textContent=e.lower.toFixed(1)})),ciUpperElements.forEach((t=>{t.textContent=e.upper.toFixed(1)})),ciText.style.display="inline"};function handleSampleCreation(e){createSamplesAndUpdateHistogram(e),renderHistogram()}function resetHistogram(){initializeBootstrapSample(),clearElementChildren(barsContainer),initializeOriginalSample(),totalBootstrappedSamplesElement.textContent="",ciLowerElements.forEach((e=>{e.textContent="?"})),ciUpperElements.forEach((e=>{e.textContent="?"})),smallestMeanElement.textContent="?",modeMeanElement.textContent="?",largestMeanElement.textContent="?",histogramData.clear(),ciText.style.display="none"}document.getElementById("create-one-sample").addEventListener("click",(()=>handleSampleCreation(1))),document.getElementById("create-fifty-samples").addEventListener("click",(()=>handleSampleCreation(50))),document.getElementById("create-five-hundred-samples").addEventListener("click",(()=>handleSampleCreation(500))),document.getElementById("reset-samples").addEventListener("click",resetHistogram),document.addEventListener("touchend",(e=>{const t=document.querySelector(".histogram-bar.active-tooltip");t&&!t.contains(e.target)&&t.classList.remove("active-tooltip")})),initializeOriginalSample(),initializeBootstrapSample();
